window["viz_jla8spO0"]= {"name":"jla8spO0","displayName":"Chart 9","dependencies":["tuyadat_1"],"transformName":"tuyadat_1_eWA6vRQ4","options":{"marker":"pivot","x":"","y":"","size":"","color":"","text":"","shape":"","facetcolumn":"","facetrow":"","barstyle":"stack","barsort":"off","label":"","colh":"","rowh":"","meas":"","scatterText":"","randomSeed":"1","treatNAAsZero":"on","mapmode":"USA-states","columns":[{"name":"uuid","type":"character","escapedName":"uuid","isNumeric":false,"isDate":false},{"name":"@timestamp.x","type":"Date","escapedName":"`@timestamp.x`","isNumeric":false,"isDate":true},{"name":"event.x","type":"character","escapedName":"event.x","isNumeric":false,"isDate":false},{"name":"first_date","type":"Date","escapedName":"first_date","isNumeric":false,"isDate":true},{"name":"last_date","type":"Date","escapedName":"last_date","isNumeric":false,"isDate":true},{"name":"age","type":"difftime","escapedName":"age","isNumeric":false,"isDate":false},{"name":"BUY.date","type":"Date","escapedName":"BUY.date","isNumeric":false,"isDate":true},{"name":"BUY","type":"character","escapedName":"BUY","isNumeric":false,"isDate":false}],"data":[[["20","20","22",null,null,null,null,null,null,null,null,null],["20","21","6","6",null,null,null,null,null,null,null,null],["20","22","8","4","8",null,null,null,null,null,null,null],["20","23","8","4","2","8",null,null,null,null,null,null],["20","24","5","3","3","1","5",null,null,null,null,null],["20","25","11","3","2","5","3","11",null,null,null,null],["20","26","18","10","10","13","9","11","18",null,null,null],["20","27","21","11","12","9","5","11","8","21",null,null],["20","28","39","23","22","18","23","18","24","24","39",null],["20","29","33","24","22","23","21","21","22","25","24","33"],["21","21",null,"74",null,null,null,null,null,null,null,null],["21","22",null,"16","16",null,null,null,null,null,null,null],["21","23",null,"12","3","12",null,null,null,null,null,null],["21","24",null,"10","2","5","10",null,null,null,null,null],["21","25",null,"19","9","6","7","19",null,null,null,null],["21","26",null,"22","13","7","6","7","22",null,null,null],["21","27",null,"34","11","14","11","12","9","34",null,null],["21","28",null,"83","37","49","29","37","40","43","83",null],["21","29",null,"82","45","46","37","45","44","44","51","82"],["22","22",null,null,"46",null,null,null,null,null,null,null],["22","23",null,null,"12","12",null,null,null,null,null,null],["22","24",null,null,"7","3","7",null,null,null,null,null],["22","25",null,null,"11","2",null,"11",null,null,null,null],["22","26",null,null,"17","7","7","5","17",null,null,null],["22","27",null,null,"26","8","6","8","7","26",null,null],["22","28",null,null,"48","23","22","26","18","24","48",null],["22","29",null,null,"35","16","12","17","18","17","16","35"],["23","23",null,null,null,"38",null,null,null,null,null,null],["23","24",null,null,null,"6","6",null,null,null,null,null],["23","25",null,null,null,"8","1","8",null,null,null,null],["23","26",null,null,null,"12","3","1","12",null,null,null],["23","27",null,null,null,"11","4","3","5","11",null,null],["23","28",null,null,null,"22","9","11","10","12","22",null],["23","29",null,null,null,"16","5","5","9","11","7","16"],["24","24",null,null,null,null,"35",null,null,null,null,null],["24","25",null,null,null,null,"5","5",null,null,null,null],["24","26",null,null,null,null,"3","2","3",null,null,null],["24","27",null,null,null,null,"10","2","4","10",null,null],["24","28",null,null,null,null,"13","7","7","6","13",null],["24","29",null,null,null,null,"7","3","2","1","4","7"],["25","25",null,null,null,null,null,"45",null,null,null,null],["25","26",null,null,null,null,null,"3","3",null,null,null],["25","27",null,null,null,null,null,"15","5","15",null,null],["25","28",null,null,null,null,null,"16","5","5","16",null],["25","29",null,null,null,null,null,"10","7","6","5","10"],["26","26",null,null,null,null,null,null,"65",null,null,null],["26","27",null,null,null,null,null,null,"6","6",null,null],["26","28",null,null,null,null,null,null,"16","8","16",null],["26","29",null,null,null,null,null,null,"10","7","3","10"],["27","27",null,null,null,null,null,null,null,"53",null,null],["27","28",null,null,null,null,null,null,null,"10","10",null],["27","29",null,null,null,null,null,null,null,"8","6","8"],["28","28",null,null,null,null,null,null,null,null,"50",null],["28","29",null,null,null,null,null,null,null,null,"8","8"],["29","29",null,null,null,null,null,null,null,null,null,"36"]],["r0","r1","20","21","22","23","24","25","26","27","28","29"],[55],[12],[null],[null]],"query":"try(jsonlite::toJSON({.dqdf <- `tuyadat_1_eWA6vRQ4`;\n.dqdf %>% \ndplyr::ungroup() %>% \ndplyr::mutate_if(bit64::is.integer64, as.numeric) %>% \nmutate_if(lubridate::is.period, lubridate::as.difftime) %>% \nmutate_if(lubridate::is.interval, lubridate::as.difftime) %>% \ndplyr::mutate(`c0`=as.character((function(x) {\n  if (!is.factor(x)) {\n    x <- factor(x) \n  }; \n  if (length(unique(x)) <= 100) {\n    return (x); \n  };\n  return (\n    forcats::fct_lump(\n      x, \n      n=100,\n      ties.method =\"first\",\n      other_level = \"Others\"\n    )\n  )\n})(`_tam_convert_na`(lubridate::yday(`@timestamp.x`), drop.unused.levels=FALSE, na.alt.text=\"NA\"))),`r0`=(function(x) {\n  if (!is.factor(x)) {\n    x <- factor(x) \n  }; \n  if (length(unique(x)) <= 100) {\n    return (x); \n  };\n  return (\n    forcats::fct_lump(\n      x, \n      n=100,\n      ties.method =\"first\",\n      other_level = \"Others\"\n    )\n  )\n})(`_tam_convert_na`(lubridate::yday(`first_date`), drop.unused.levels=FALSE, na.alt.text=\"(NA)\")),`r1`=(function(x) {\n  if (!is.factor(x)) {\n    x <- factor(x) \n  }; \n  if (length(unique(x)) <= 100) {\n    return (x); \n  };\n  return (\n    forcats::fct_lump(\n      x, \n      n=100,\n      ties.method =\"first\",\n      other_level = \"Others\"\n    )\n  )\n})(`_tam_convert_na`(lubridate::yday(`last_date`), drop.unused.levels=FALSE, na.alt.text=\"(NA)\")),`m0`=`uuid`) %>% \ndplyr::group_by(c0,r0,r1, .drop=TRUE) %>% \ndplyr::summarize(`m0`=n_distinct(`m0`),m0.nrow = n()) %>% \nungroup() %>% \ndplyr::mutate(m0 = (function(x, y){x[y==0]<-NA; return(x)})(m0,m0.nrow)) %>% \ndplyr::select(-m0.nrow) %>% \n(function(x) { .dqdf_ctotal <<- NA; return (x) })  %>% \n(function(x) { .dqdf_rtotal <<- NA; return (x) })  %>% \n(function(x) { .dqdf_gtotal <<- NA; return (x) })  %>% \ndplyr::ungroup() %>% \ndplyr::arrange(c0) %>% \ndplyr::mutate(c0 = fct_inorder(fct_explicit_na(factor(c0), na_level = \"NA\"))) %>% \ndplyr::mutate(m0= exploratory::impute_na(as.character(m0), type = \"value\", val = \"\")) %>% \ntidyr::unite(.pivot.measure.cell, m0, sep=\",\") %>% \n(function(x) { if(nrow(x) > 0) { return (tidyr::spread(x, c0, .pivot.measure.cell)); } else { return (  dplyr::select(x, -c0, -.pivot.measure.cell)) }})  %>% \ndplyr::ungroup() %>% \ndplyr::arrange(r0,r1) %>% \n(function(df) { \n  .nrow <- nrow(df)\n  .ncol.org <- ncol(df)\n  .ncol <- min(.ncol.org, 302)\n  `_tam_setCurrentVizDataCache`(df, type=\"pivot\", colnames=c(\"first_date\",\"last_date\"), nrowh=2, nmeas=1, colorbucket=FALSE)\n  .maxcell <- 10000\n  df <- df %>% dplyr::select(1:.ncol)\n  if (.nrow * .ncol > .maxcell) {\n    .maxrows <- as.integer(.maxcell/.ncol)\n    df <- dplyr::slice(df, 1:.maxrows)\n  }\n  df <- df %>% `_tam_convertLogicalToCharacter`()\n  return (list(df, colnames(df), .nrow, .ncol.org, .dqdf_ctotal, .dqdf_rtotal))\n})\n}\n, na=\"null\" , dataframe=\"values\", digits=10))","pieHole":"55","pivotShowTotals":"off","pivotShowRowTotals":"off","_desktopVersion":"5.4.2.2","displayName":"Chart 9","sampleDataSize":0,"sortTarget":null,"yUse2ndAxis":null,"colorBucketGroup":null,"xBucketGroup":null,"yBucketGroup":null,"y0":null,"pivotColor":"none","height":500,"width":800,"pivotClientSortIndex":null,"pivotClientSortDirection":null,"rowh0":{"name":"first_date","validName":"first_date","type":"Date","isNumeric":false,"isDate":true,"func":"dayofyear","label":"c1","validLabel":"c1"},"meas0":{"name":"uuid","validName":"uuid","isNumeric":false,"isDate":false,"type":"character","func":"countd","label":"c4","validLabel":"c4"},"meas0WindowFuncDirection":null,"colh0":{"name":"@timestamp.x","validName":"`@timestamp.x`","type":"Date","isNumeric":false,"isDate":true,"func":"dayofyear","label":"c3","validLabel":"c3"},"meas0EnableOtherGroup":null,"meas0NumGroupsToPreserve":null,"meas0ShowOtherGroup":null,"meas0OtherGroupLabel":null,"meas0OtherGroupValues":null,"rowh1":{"name":"last_date","validName":"last_date","type":"Date","isNumeric":false,"isDate":true,"func":"dayofyear","label":"c2","validLabel":"c2"},"rowh1EnableOtherGroup":null,"rowh1NumGroupsToPreserve":null,"rowh1ShowOtherGroup":null,"rowh1OtherGroupLabel":null,"rowh1OtherGroupValues":null,"colh0EnableOtherGroup":null,"colh0NumGroupsToPreserve":null,"colh0ShowOtherGroup":null,"colh0OtherGroupLabel":null,"colh0OtherGroupValues":null,"maxNUniqOnRC":"","pivotMaxNumRows":"","pivotMasterFontSize":"","pivotShowUnusedFactorLevels":"off","numDecimalDigits":"","useThousandSeparator":"on","title":"","titleFontSize":"","rowh0Title":"","rowh0CellWidth":"","rowh1Title":"","rowh1CellWidth":"","meas0CellWidth":"","pivotHideDataCells":"off","pivotSortWithinGroup":"on","meas0Title":"","meas0CurrencySymbol":"","colh0Title":"每日登录设备数","colh0ShowFuncName":"on"},"timestamp":"2020-01-30T12:36:28.252Z","updatedBy":"","thumbnail":null,"snapshot":null,"publicTitle":"","publicDescription":"","publicDataSourceURL":"","withSteps":false,"privateShare":true,"sharedURL":"","previousSharedURL":"","sharedDate":null,"publishSizeOption":null,"insightMetaInfo":{"version":1,"url":null,"isPrivate":false,"thumbnail":null,"title":"","description":"","learnMoreUrl":null,"exampleUrl":null,"sharedFileTypes":[],"withSteps":false,"dataSourceURL":""},"preprocessor":"","_tags":null,"filterCommand":{"name":"filter","conditions":[]},"variables":[],"tabIndex":8,"_isDirty":false,"_createdVersion":"5.4.2.2","annotation":"","_tempAnnotation":"","_tempDisplayName":"","_thumbnailFileName":""}